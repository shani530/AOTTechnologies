[2020-03-02 08:19:38,029] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-03-02 08:23:18,488] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 08:23:18,630] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 15 and epoch zk version is now 15 (kafka.controller.KafkaController)
[2020-03-02 08:23:18,630] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 08:23:18,638] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 08:23:18,650] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 08:23:18,673] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 08:23:18,760] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 375) (kafka.controller.KafkaController)
[2020-03-02 08:23:18,828] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 08:23:18,952] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 08:23:18,996] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 08:23:18,997] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 08:23:18,998] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition) (kafka.controller.KafkaController)
[2020-03-02 08:23:18,999] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 08:23:19,010] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 08:23:19,044] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 08:23:19,045] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-02 08:23:19,046] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 08:23:19,047] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2020-03-02 08:23:19,049] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 08:23:19,075] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:23:19,194] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:23:19,274] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 08:23:19,433] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:23:19,434] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=myjob,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=0,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:23:19,436] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:23:19,448] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:23:19,453] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, my_first-0 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, myfirst-0 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, TextLinesTopic-1 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, wordcount-application-counts-store-repartition-2 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, WordsWithCountsTopic-2 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, myfirst-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, invoice-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, TextLinesTopic-0 -> OnlinePartition, wordcount-application-counts-store-changelog-2 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, wordcount-application-counts-store-repartition-0 -> OnlinePartition, myfirst-2 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, WordsWithCountsTopic-1 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, wordcount-application-counts-store-changelog-1 -> OnlinePartition, invoice-1 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, myjob-0 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, WordsWithCountsTopic-0 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, TextLinesTopic-2 -> OnlinePartition, invoice-2 -> OnlinePartition, wordcount-application-counts-store-changelog-0 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, wordcount-application-counts-store-repartition-1 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:23:19,454] INFO [Controller id=0] Ready to serve as the new controller with epoch 15 (kafka.controller.KafkaController)
[2020-03-02 08:23:19,466] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 08:23:19,467] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 08:23:19,467] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 08:23:19,468] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 08:23:19,481] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 08:23:19,562] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 08:23:24,565] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 08:23:24,566] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 08:23:24,582] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 08:23:24,588] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 08:23:24,590] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 08:29:40,572] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 08:29:40,628] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 16 and epoch zk version is now 16 (kafka.controller.KafkaController)
[2020-03-02 08:29:40,629] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 08:29:40,635] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 08:29:40,649] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 08:29:40,653] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 08:29:40,679] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 424) (kafka.controller.KafkaController)
[2020-03-02 08:29:40,726] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 08:29:40,970] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 08:29:40,997] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 08:29:40,998] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 08:29:41,000] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition) (kafka.controller.KafkaController)
[2020-03-02 08:29:41,001] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 08:29:41,002] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 08:29:41,024] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 08:29:41,051] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-02 08:29:41,052] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 08:29:41,053] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2020-03-02 08:29:41,054] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 08:29:41,086] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:29:41,125] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:29:41,132] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 08:29:41,290] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:29:41,293] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=myjob,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=0,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:29:41,294] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:29:41,304] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:29:41,309] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, my_first-0 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, myfirst-0 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, TextLinesTopic-1 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, wordcount-application-counts-store-repartition-2 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, WordsWithCountsTopic-2 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, myfirst-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, invoice-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, TextLinesTopic-0 -> OnlinePartition, wordcount-application-counts-store-changelog-2 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, wordcount-application-counts-store-repartition-0 -> OnlinePartition, myfirst-2 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, WordsWithCountsTopic-1 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, wordcount-application-counts-store-changelog-1 -> OnlinePartition, invoice-1 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, myjob-0 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, WordsWithCountsTopic-0 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, TextLinesTopic-2 -> OnlinePartition, invoice-2 -> OnlinePartition, wordcount-application-counts-store-changelog-0 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, wordcount-application-counts-store-repartition-1 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:29:41,310] INFO [Controller id=0] Ready to serve as the new controller with epoch 16 (kafka.controller.KafkaController)
[2020-03-02 08:29:41,333] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 08:29:41,334] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 08:29:41,334] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 08:29:41,335] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 08:29:41,338] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 08:29:41,498] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 08:29:46,509] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 08:29:46,511] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 08:29:46,522] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 08:29:46,527] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 08:29:46,531] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 08:49:51,860] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 08:49:51,905] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 17 and epoch zk version is now 17 (kafka.controller.KafkaController)
[2020-03-02 08:49:51,906] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 08:49:51,912] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 08:49:51,920] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 08:49:51,924] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 08:49:51,949] INFO [Controller id=2] Initialized broker epochs cache: Map(2 -> 458) (kafka.controller.KafkaController)
[2020-03-02 08:49:52,000] DEBUG [Controller id=2] Register BrokerModifications handler for Set(2) (kafka.controller.KafkaController)
[2020-03-02 08:49:52,123] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 08:49:52,206] INFO [Controller id=2] Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2020-03-02 08:49:52,207] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-03-02 08:49:52,208] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 08:49:52,209] INFO [Controller id=2] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition) (kafka.controller.KafkaController)
[2020-03-02 08:49:52,209] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 08:49:52,223] INFO [Controller id=2] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 08:49:52,224] INFO [Controller id=2] List of topics ineligible for deletion: myjob,myfirst,WordsWithCountsTopic,__consumer_offsets,invoice,TextLinesTopic,wordcount-application-counts-store-changelog,my_first,wordcount-application-counts-store-repartition (kafka.controller.KafkaController)
[2020-03-02 08:49:52,225] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 08:49:52,226] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(myjob, myfirst, WordsWithCountsTopic, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition) (kafka.controller.TopicDeletionManager)
[2020-03-02 08:49:52,227] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 08:49:52,251] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:49:52,266] INFO [RequestSendThread controllerId=2] Controller 2 connected to DELL-PC:9092 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 08:49:52,271] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:49:52,280] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:49:52,794] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=my_first,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=myjob,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=0,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 08:49:52,795] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:49:52,807] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:49:52,978] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, my_first-0 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, myfirst-0 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, TextLinesTopic-1 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, wordcount-application-counts-store-repartition-2 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, WordsWithCountsTopic-2 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, myfirst-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, invoice-0 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, TextLinesTopic-0 -> OfflinePartition, wordcount-application-counts-store-changelog-2 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, wordcount-application-counts-store-repartition-0 -> OfflinePartition, myfirst-2 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, WordsWithCountsTopic-1 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, wordcount-application-counts-store-changelog-1 -> OfflinePartition, invoice-1 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, myjob-0 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, WordsWithCountsTopic-0 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, TextLinesTopic-2 -> OfflinePartition, invoice-2 -> OfflinePartition, wordcount-application-counts-store-changelog-0 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, wordcount-application-counts-store-repartition-1 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 08:49:52,979] INFO [Controller id=2] Ready to serve as the new controller with epoch 17 (kafka.controller.KafkaController)
[2020-03-02 08:49:52,998] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 08:49:52,999] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 08:49:53,000] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 08:49:53,000] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 08:49:53,003] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 08:49:53,030] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 08:49:58,033] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 08:49:58,034] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 08:49:58,047] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 08:49:58,055] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 08:49:58,058] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 08:49:58,068] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 08:54:58,077] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 08:54:58,077] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 08:54:58,086] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 08:54:58,089] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 08:54:58,089] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 08:54:58,092] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 08:59:58,100] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 08:59:58,100] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 08:59:58,111] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 08:59:58,114] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 08:59:58,114] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 08:59:58,116] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:00:36,368] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:00:36,418] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 18 and epoch zk version is now 18 (kafka.controller.KafkaController)
[2020-03-02 09:00:36,419] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:00:36,424] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:00:36,431] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:00:36,462] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:00:36,525] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 577) (kafka.controller.KafkaController)
[2020-03-02 09:00:36,555] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:00:36,716] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:00:36,759] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:00:36,760] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:00:36,761] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:00:36,762] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition) (kafka.controller.KafkaController)
[2020-03-02 09:00:36,762] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:00:36,780] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 09:00:36,781] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:00:36,783] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:00:36,784] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2020-03-02 09:00:36,785] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:00:36,820] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:00:36,845] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:00:36,866] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:00:37,090] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:00:37,091] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=myjob,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=0,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:00:37,093] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:00:37,101] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:00:37,626] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, my_first-0 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, myfirst-0 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, TextLinesTopic-1 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, wordcount-application-counts-store-repartition-2 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, WordsWithCountsTopic-2 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, myfirst-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, invoice-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, TextLinesTopic-0 -> OnlinePartition, wordcount-application-counts-store-changelog-2 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, wordcount-application-counts-store-repartition-0 -> OnlinePartition, myfirst-2 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, WordsWithCountsTopic-1 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, wordcount-application-counts-store-changelog-1 -> OnlinePartition, invoice-1 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, myjob-0 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, WordsWithCountsTopic-0 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, TextLinesTopic-2 -> OnlinePartition, invoice-2 -> OnlinePartition, wordcount-application-counts-store-changelog-0 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, wordcount-application-counts-store-repartition-1 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:00:37,627] INFO [Controller id=0] Ready to serve as the new controller with epoch 18 (kafka.controller.KafkaController)
[2020-03-02 09:00:37,650] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:00:37,651] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:00:37,652] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:00:37,653] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:00:37,656] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:00:37,683] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:00:42,687] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:00:42,687] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:00:42,696] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 09:00:42,699] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:00:42,702] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:00:53,882] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2020-03-02 09:00:53,884] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:00:53,896] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:00:53,899] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-03-02 09:00:53,935] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:00:53,941] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2020-03-02 09:00:53,944] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 577, 2 -> 665) (kafka.controller.KafkaController)
[2020-03-02 09:00:54,000] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:00:54,029] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:01:28,802] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-03-02 09:01:28,802] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:01:28,813] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:01:28,813] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-03-02 09:01:28,824] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2020-03-02 09:01:28,825] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 577, 2 -> 665, 1 -> 681) (kafka.controller.KafkaController)
[2020-03-02 09:01:28,825] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:01:28,968] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:01:29,008] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:02:44,752] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-03-02 09:03:16,787] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-03-02 09:04:02,508] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:04:02,803] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 19 and epoch zk version is now 19 (kafka.controller.KafkaController)
[2020-03-02 09:04:02,808] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:04:02,899] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:04:02,952] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:04:03,070] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:04:03,175] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 700) (kafka.controller.KafkaController)
[2020-03-02 09:04:03,506] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:04:04,050] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:04:04,078] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:04:04,079] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:04:04,080] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition) (kafka.controller.KafkaController)
[2020-03-02 09:04:04,081] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:04:04,122] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:04:04,224] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 09:04:04,224] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:04:04,225] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:04:04,227] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2020-03-02 09:04:04,228] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:04:04,260] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:04:04,276] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:04:04,324] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:04:04,541] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:04:04,543] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=myjob,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=0,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:04:04,616] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:04:04,630] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:04:04,635] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, my_first-0 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, myfirst-0 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, TextLinesTopic-1 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, wordcount-application-counts-store-repartition-2 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, WordsWithCountsTopic-2 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, myfirst-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, invoice-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, TextLinesTopic-0 -> OnlinePartition, wordcount-application-counts-store-changelog-2 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, wordcount-application-counts-store-repartition-0 -> OnlinePartition, myfirst-2 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, WordsWithCountsTopic-1 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, wordcount-application-counts-store-changelog-1 -> OnlinePartition, invoice-1 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, myjob-0 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, WordsWithCountsTopic-0 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, TextLinesTopic-2 -> OnlinePartition, invoice-2 -> OnlinePartition, wordcount-application-counts-store-changelog-0 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, wordcount-application-counts-store-repartition-1 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:04:04,637] INFO [Controller id=0] Ready to serve as the new controller with epoch 19 (kafka.controller.KafkaController)
[2020-03-02 09:04:04,796] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:04:04,797] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:04:04,798] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:04:04,800] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:04:04,803] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:04:04,885] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:04:09,889] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,2 (kafka.controller.KafkaController)
[2020-03-02 09:04:09,890] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:04:09,901] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:04:09,909] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-03-02 09:04:09,926] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:04:09,934] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2020-03-02 09:04:09,943] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 700, 2 -> 718) (kafka.controller.KafkaController)
[2020-03-02 09:04:09,945] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:04:09,946] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:04:09,965] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), TextLinesTopic-0 -> List(0))) (kafka.controller.KafkaController)
[2020-03-02 09:04:09,971] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:04:09,975] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:04:10,119] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:04:10,173] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:04:13,739] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-03-02 09:04:13,739] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:04:13,749] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-03-02 09:04:13,759] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2020-03-02 09:04:13,767] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:04:13,768] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 700, 2 -> 718, 1 -> 734) (kafka.controller.KafkaController)
[2020-03-02 09:04:13,770] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:04:13,908] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:04:13,956] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:06:04,287] INFO [Controller id=0] New topics: [HashSet(hello-producer-topic)], deleted topics: [HashSet()], new partition replica assignment [HashMap(hello-producer-topic-0 -> ReplicaAssignment(replicas=2,0,1, addingReplicas=, removingReplicas=), hello-producer-topic-2 -> ReplicaAssignment(replicas=1,2,0, addingReplicas=, removingReplicas=), hello-producer-topic-1 -> ReplicaAssignment(replicas=0,1,2, addingReplicas=, removingReplicas=), hello-producer-topic-3 -> ReplicaAssignment(replicas=2,1,0, addingReplicas=, removingReplicas=), hello-producer-topic-4 -> ReplicaAssignment(replicas=0,2,1, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-03-02 09:06:04,296] INFO [Controller id=0] New partition creation callback for hello-producer-topic-0,hello-producer-topic-2,hello-producer-topic-1,hello-producer-topic-3,hello-producer-topic-4 (kafka.controller.KafkaController)
[2020-03-02 09:09:09,984] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:09:09,984] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:09:09,991] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 09:09:09,992] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:09:09,992] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:09:09,992] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:09:09,992] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:09:09,992] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:09:09,992] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:13:54,816] INFO [Controller id=0] New topics: [HashSet(hello-producer-topic-sample)], deleted topics: [HashSet()], new partition replica assignment [HashMap(hello-producer-topic-sample-0 -> ReplicaAssignment(replicas=0,1, addingReplicas=, removingReplicas=), hello-producer-topic-sample-3 -> ReplicaAssignment(replicas=0,2, addingReplicas=, removingReplicas=), hello-producer-topic-sample-4 -> ReplicaAssignment(replicas=1,0, addingReplicas=, removingReplicas=), hello-producer-topic-sample-1 -> ReplicaAssignment(replicas=1,2, addingReplicas=, removingReplicas=), hello-producer-topic-sample-2 -> ReplicaAssignment(replicas=2,0, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-03-02 09:13:54,816] INFO [Controller id=0] New partition creation callback for hello-producer-topic-sample-0,hello-producer-topic-sample-3,hello-producer-topic-sample-4,hello-producer-topic-sample-1,hello-producer-topic-sample-2 (kafka.controller.KafkaController)
[2020-03-02 09:14:10,000] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:14:10,000] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-30 -> List(0), hello-producer-topic-sample-0 -> List(0, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), hello-producer-topic-sample-3 -> List(0, 2), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-sample-4 -> List(1, 0), hello-producer-topic-2 -> List(1, 2, 0), hello-producer-topic-sample-1 -> List(1, 2)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1), hello-producer-topic-sample-2 -> List(2, 0))) (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:14:10,003] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:14:24,401] DEBUG [Controller id=0] Delete topics listener fired for topics hello-producer-topic-sample to be deleted (kafka.controller.KafkaController)
[2020-03-02 09:14:24,402] INFO [Controller id=0] Starting topic deletion for topics hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:14:24,405] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,408] INFO [Topic Deletion Manager 0] Deletion of topic hello-producer-topic-sample (re)started (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,409] INFO [Topic Deletion Manager 0] Topic deletion callback for hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,422] INFO [Topic Deletion Manager 0] Partition deletion callback for hello-producer-topic-sample-0,hello-producer-topic-sample-3,hello-producer-topic-sample-4,hello-producer-topic-sample-1,hello-producer-topic-sample-2 (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,651] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:14:24,653] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:14:24,653] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=2],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=2],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:14:24,654] DEBUG [Topic Deletion Manager 0] Deletion started for replicas [Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=3,Replica=2],[Topic=hello-producer-topic-sample,Partition=1,Replica=1],[Topic=hello-producer-topic-sample,Partition=4,Replica=0],[Topic=hello-producer-topic-sample,Partition=1,Replica=2] (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,658] DEBUG The stop replica request (delete = true) sent to broker 0 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=0],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:14:24,660] DEBUG The stop replica request (delete = true) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:14:24,661] DEBUG The stop replica request (delete = true) sent to broker 2 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=2],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=2],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=2],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:14:24,867] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 1: request error = NONE, partition errors = Map(hello-producer-topic-sample-1 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-0 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-4 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2020-03-02 09:14:24,871] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=hello-producer-topic-sample,Partition=1,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=4,Replica=1]. Halting deletion for topics Set(hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,875] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:24,883] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,032] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 2: request error = NONE, partition errors = Map(hello-producer-topic-sample-1 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-3 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-2 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2020-03-02 09:14:25,033] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=hello-producer-topic-sample,Partition=1,Replica=2],[Topic=hello-producer-topic-sample,Partition=3,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=2]. Halting deletion for topics Set(hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,034] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,034] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,162] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = Map(hello-producer-topic-sample-0 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-3 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-2 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-4 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2020-03-02 09:14:25,163] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=0]. Halting deletion for topics Set(hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,164] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,164] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:14:25,166] INFO [Topic Deletion Manager 0] Retrying deletion of topic hello-producer-topic-sample since replicas [Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=3,Replica=2],[Topic=hello-producer-topic-sample,Partition=1,Replica=1],[Topic=hello-producer-topic-sample,Partition=4,Replica=0],[Topic=hello-producer-topic-sample,Partition=1,Replica=2] were not successfully deleted (kafka.controller.TopicDeletionManager)
[2020-03-02 09:15:53,965] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:15:54,042] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 20 and epoch zk version is now 20 (kafka.controller.KafkaController)
[2020-03-02 09:15:54,043] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:15:54,067] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:15:54,076] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:15:54,083] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:15:54,121] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 804) (kafka.controller.KafkaController)
[2020-03-02 09:15:54,166] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:15:54,319] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:15:54,341] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:15:54,351] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:15:54,352] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 09:15:54,353] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:15:54,357] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:15:54,437] INFO [Controller id=0] List of topics to be deleted: hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:15:54,438] INFO [Controller id=0] List of topics ineligible for deletion: hello-producer-topic,hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:15:54,439] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:15:54,440] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(hello-producer-topic-sample), initial ineligible deletions: HashSet(hello-producer-topic, hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:15:54,443] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:15:54,489] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:15:54,510] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:15:54,512] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:15:54,613] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:15:54,773] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=2] -> OfflineReplica, [Topic=my_first,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=myjob,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=2] -> OfflineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OfflineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OfflineReplica, [Topic=invoice,Partition=1,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=1] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:15:54,776] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:15:54,857] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:15:55,107] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, my_first-0 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, hello-producer-topic-sample-2 -> OfflinePartition, __consumer_offsets-17 -> OnlinePartition, hello-producer-topic-2 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, myfirst-0 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, TextLinesTopic-1 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, wordcount-application-counts-store-repartition-2 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, hello-producer-topic-sample-1 -> OfflinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, hello-producer-topic-3 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, WordsWithCountsTopic-2 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, myfirst-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, invoice-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, TextLinesTopic-0 -> OnlinePartition, wordcount-application-counts-store-changelog-2 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, hello-producer-topic-sample-0 -> OfflinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, hello-producer-topic-4 -> OnlinePartition, hello-producer-topic-sample-4 -> OfflinePartition, hello-producer-topic-0 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, wordcount-application-counts-store-repartition-0 -> OnlinePartition, myfirst-2 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, WordsWithCountsTopic-1 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, wordcount-application-counts-store-changelog-1 -> OnlinePartition, invoice-1 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, myjob-0 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, hello-producer-topic-sample-3 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, hello-producer-topic-1 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, WordsWithCountsTopic-0 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, TextLinesTopic-2 -> OnlinePartition, invoice-2 -> OnlinePartition, wordcount-application-counts-store-changelog-0 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, wordcount-application-counts-store-repartition-1 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:15:55,108] INFO [Controller id=0] Ready to serve as the new controller with epoch 20 (kafka.controller.KafkaController)
[2020-03-02 09:15:55,123] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:15:55,138] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:15:55,138] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:15:55,139] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:15:55,140] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:15:55,142] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:15:55,237] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:16:00,241] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:16:00,241] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:16:00,254] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 09:16:00,258] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 09:16:00,262] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 09:16:00,262] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 09:16:00,262] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:16:00,269] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:16:00,270] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 09:16:00,270] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:16:00,270] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:16:36,588] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-03-02 09:16:36,589] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:16:36,602] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-03-02 09:16:36,619] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:16:36,631] INFO [Controller id=0] Some replicas [Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=1,Replica=1] for topics scheduled for deletion hello-producer-topic-sample are on the newly restarted brokers 1. Signaling restart of topic deletion for these topics (kafka.controller.KafkaController)
[2020-03-02 09:16:36,641] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,642] INFO [Topic Deletion Manager 0] Deletion of topic hello-producer-topic-sample (re)started (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,645] INFO [Topic Deletion Manager 0] Topic deletion callback for hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,668] INFO [Topic Deletion Manager 0] Partition deletion callback for hello-producer-topic-sample-0,hello-producer-topic-sample-3,hello-producer-topic-sample-4,hello-producer-topic-sample-1,hello-producer-topic-sample-2 (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,687] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:16:36,704] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:16:36,705] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:16:36,706] DEBUG [Topic Deletion Manager 0] Deletion started for replicas [Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=1,Replica=1] (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,756] DEBUG The stop replica request (delete = true) sent to broker 0 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=0],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:16:36,758] DEBUG The stop replica request (delete = true) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:16:36,759] DEBUG [Topic Deletion Manager 0] Dead Replicas ([Topic=hello-producer-topic-sample,Partition=1,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=3,Replica=2]) found for topic hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,761] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to offline replicas (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:36,761] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2020-03-02 09:16:36,763] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:16:36,791] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 804, 1 -> 840) (kafka.controller.KafkaController)
[2020-03-02 09:16:37,087] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:16:44,887] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 21 and epoch zk version is now 21 (kafka.controller.KafkaController)
[2020-03-02 09:16:44,888] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:16:44,895] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:16:44,900] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:16:44,903] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:16:44,913] INFO [Controller id=1] Initialized broker epochs cache: Map(1 -> 840) (kafka.controller.KafkaController)
[2020-03-02 09:16:44,933] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2020-03-02 09:16:44,989] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:16:45,003] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:16:45,004] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2020-03-02 09:16:45,004] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:16:45,005] INFO [Controller id=1] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 09:16:45,005] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:16:45,014] INFO [Controller id=1] List of topics to be deleted: hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:16:45,015] INFO [Controller id=1] List of topics ineligible for deletion: myjob,myfirst,WordsWithCountsTopic,hello-producer-topic-sample,__consumer_offsets,invoice,TextLinesTopic,wordcount-application-counts-store-changelog,my_first,wordcount-application-counts-store-repartition,hello-producer-topic (kafka.controller.KafkaController)
[2020-03-02 09:16:45,016] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:16:45,017] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(hello-producer-topic-sample), initial ineligible deletions: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:45,017] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:16:45,030] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:16:45,038] INFO [RequestSendThread controllerId=1] Controller 1 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:16:45,043] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:16:45,101] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:16:45,519] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=2] -> OfflineReplica, [Topic=my_first,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=myjob,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=2] -> OfflineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=1] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OnlineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OfflineReplica, [Topic=invoice,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=1] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:16:45,521] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:16:45,534] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:16:45,675] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, my_first-0 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, hello-producer-topic-sample-2 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, hello-producer-topic-2 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, myfirst-0 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, TextLinesTopic-1 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, wordcount-application-counts-store-repartition-2 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, hello-producer-topic-sample-1 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, hello-producer-topic-3 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, WordsWithCountsTopic-2 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, myfirst-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, invoice-0 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, TextLinesTopic-0 -> OfflinePartition, wordcount-application-counts-store-changelog-2 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, hello-producer-topic-sample-0 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, hello-producer-topic-4 -> OfflinePartition, hello-producer-topic-sample-4 -> OfflinePartition, hello-producer-topic-0 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, wordcount-application-counts-store-repartition-0 -> OfflinePartition, myfirst-2 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, WordsWithCountsTopic-1 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, wordcount-application-counts-store-changelog-1 -> OfflinePartition, invoice-1 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, myjob-0 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, hello-producer-topic-sample-3 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, hello-producer-topic-1 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, WordsWithCountsTopic-0 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, TextLinesTopic-2 -> OfflinePartition, invoice-2 -> OfflinePartition, wordcount-application-counts-store-changelog-0 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, wordcount-application-counts-store-repartition-1 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:16:45,676] INFO [Controller id=1] Ready to serve as the new controller with epoch 21 (kafka.controller.KafkaController)
[2020-03-02 09:16:45,680] INFO [Topic Deletion Manager 1] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:16:45,687] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:16:45,688] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:16:45,689] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:16:45,689] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:16:45,692] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:16:45,805] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:16:50,809] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:16:50,810] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:16:50,823] DEBUG [Controller id=1] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 09:16:50,832] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 09:16:50,835] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:16:50,841] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:16:50,841] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 09:16:50,841] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:16:50,844] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-2 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:16:50,851] ERROR [Controller id=1] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-2 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-2 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 09:16:50,852] WARN [Controller id=1] Partition hello-producer-topic-2 failed to complete preferred replica leader election to 1. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 09:16:50,852] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 09:16:50,852] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:16:50,852] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:17:06,509] INFO [Controller id=1] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 1,2 (kafka.controller.KafkaController)
[2020-03-02 09:17:06,510] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:17:06,524] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:17:06,527] INFO [Controller id=1] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-03-02 09:17:06,544] INFO [RequestSendThread controllerId=1] Controller 1 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:17:06,662] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:17:06,731] INFO [Controller id=1] Some replicas [Topic=hello-producer-topic-sample,Partition=1,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=3,Replica=2] for topics scheduled for deletion hello-producer-topic-sample are on the newly restarted brokers 2. Signaling restart of topic deletion for these topics (kafka.controller.KafkaController)
[2020-03-02 09:17:06,736] INFO [Topic Deletion Manager 1] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,739] INFO [Topic Deletion Manager 1] Deletion of topic hello-producer-topic-sample (re)started (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,740] INFO [Topic Deletion Manager 1] Topic deletion callback for hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,754] INFO [Topic Deletion Manager 1] Partition deletion callback for hello-producer-topic-sample-0,hello-producer-topic-sample-3,hello-producer-topic-sample-4,hello-producer-topic-sample-1,hello-producer-topic-sample-2 (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,780] DEBUG [Controller id=2] Broker 1 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:17:06,825] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:17:06,826] DEBUG The stop replica request (delete = false) sent to broker 2 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=2],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=2],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=2],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:17:06,827] DEBUG [Topic Deletion Manager 1] Deletion started for replicas [Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=1,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=3,Replica=2],[Topic=hello-producer-topic-sample,Partition=1,Replica=1] (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,834] DEBUG The stop replica request (delete = true) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:17:06,835] DEBUG The stop replica request (delete = true) sent to broker 2 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=2],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=2],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=2],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:17:06,836] DEBUG [Topic Deletion Manager 1] Dead Replicas ([Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=0]) found for topic hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,838] INFO [Topic Deletion Manager 1] Halted deletion of topics hello-producer-topic-sample due to offline replicas (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,838] DEBUG [Controller id=1] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2020-03-02 09:17:06,853] INFO [Controller id=1] Updated broker epochs cache: Map(1 -> 840, 2 -> 939) (kafka.controller.KafkaController)
[2020-03-02 09:17:06,955] DEBUG [Controller id=1] Delete topic callback invoked on StopReplica response received from broker 1: request error = NONE, partition errors = Map(hello-producer-topic-sample-1 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-0 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-4 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2020-03-02 09:17:06,965] DEBUG [Topic Deletion Manager 1] Deletion failed for replicas [Topic=hello-producer-topic-sample,Partition=1,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=4,Replica=1]. Halting deletion for topics Set(hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,967] INFO [Topic Deletion Manager 1] Halted deletion of topics hello-producer-topic-sample due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:06,967] INFO [Topic Deletion Manager 1] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:14,887] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 22 and epoch zk version is now 22 (kafka.controller.KafkaController)
[2020-03-02 09:17:14,888] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:17:14,895] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:17:14,900] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:17:14,904] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:17:14,914] INFO [Controller id=2] Initialized broker epochs cache: Map(2 -> 939) (kafka.controller.KafkaController)
[2020-03-02 09:17:14,937] DEBUG [Controller id=2] Register BrokerModifications handler for Set(2) (kafka.controller.KafkaController)
[2020-03-02 09:17:14,989] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:17:15,003] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:17:15,004] INFO [Controller id=2] Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2020-03-02 09:17:15,005] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:17:15,005] INFO [Controller id=2] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 09:17:15,006] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:17:15,015] INFO [Controller id=2] List of topics to be deleted: hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:17:15,016] INFO [Controller id=2] List of topics ineligible for deletion: myjob,myfirst,WordsWithCountsTopic,hello-producer-topic-sample,__consumer_offsets,invoice,TextLinesTopic,wordcount-application-counts-store-changelog,my_first,wordcount-application-counts-store-repartition,hello-producer-topic (kafka.controller.KafkaController)
[2020-03-02 09:17:15,016] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:17:15,017] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(hello-producer-topic-sample), initial ineligible deletions: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:15,018] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:17:15,031] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:17:15,045] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:17:15,054] INFO [RequestSendThread controllerId=2] Controller 2 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:17:15,103] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:17:15,478] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=2] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=myjob,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=2] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OfflineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=1] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:17:15,480] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:17:15,499] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:17:15,698] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, my_first-0 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, hello-producer-topic-sample-2 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, hello-producer-topic-2 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, myfirst-0 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, TextLinesTopic-1 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, wordcount-application-counts-store-repartition-2 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, hello-producer-topic-sample-1 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, hello-producer-topic-3 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, WordsWithCountsTopic-2 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, myfirst-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, invoice-0 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, TextLinesTopic-0 -> OfflinePartition, wordcount-application-counts-store-changelog-2 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, hello-producer-topic-sample-0 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, hello-producer-topic-4 -> OfflinePartition, hello-producer-topic-sample-4 -> OfflinePartition, hello-producer-topic-0 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, wordcount-application-counts-store-repartition-0 -> OfflinePartition, myfirst-2 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, WordsWithCountsTopic-1 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, wordcount-application-counts-store-changelog-1 -> OfflinePartition, invoice-1 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, myjob-0 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, hello-producer-topic-sample-3 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, hello-producer-topic-1 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, WordsWithCountsTopic-0 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, TextLinesTopic-2 -> OfflinePartition, invoice-2 -> OfflinePartition, wordcount-application-counts-store-changelog-0 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, wordcount-application-counts-store-repartition-1 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:17:15,699] INFO [Controller id=2] Ready to serve as the new controller with epoch 22 (kafka.controller.KafkaController)
[2020-03-02 09:17:15,705] INFO [Topic Deletion Manager 2] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:17:15,715] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:17:15,716] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:17:15,717] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:17:15,717] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:17:15,720] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:17:15,747] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:17:20,750] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:17:20,751] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:17:20,764] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 09:17:20,770] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 09:17:20,774] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:17:20,780] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:17:20,780] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 09:17:20,780] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:17:20,780] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:17:20,780] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 09:17:20,781] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:17:20,783] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:17:20,792] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 09:17:20,793] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-3 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 09:17:20,794] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 09:17:20,794] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 09:19:21,869] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-03-02 09:19:46,687] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:19:47,026] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 23 and epoch zk version is now 23 (kafka.controller.KafkaController)
[2020-03-02 09:19:47,027] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:19:47,185] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:19:47,217] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:19:47,246] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:19:47,280] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 1055) (kafka.controller.KafkaController)
[2020-03-02 09:19:47,695] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:19:48,481] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:19:48,508] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 09:19:48,509] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:19:48,510] INFO [Controller id=0] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 09:19:48,510] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:19:48,519] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:19:48,628] INFO [Controller id=0] List of topics to be deleted: hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:19:48,740] INFO [Controller id=0] List of topics ineligible for deletion: hello-producer-topic,hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:19:48,741] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:19:48,742] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(hello-producer-topic-sample), initial ineligible deletions: HashSet(hello-producer-topic, hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:48,743] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:19:48,771] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:19:48,840] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:19:48,895] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:19:49,092] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:19:50,452] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=2] -> OfflineReplica, [Topic=my_first,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=myjob,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=2] -> OfflineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OnlineReplica, [Topic=invoice,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OfflineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OfflineReplica, [Topic=invoice,Partition=1,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=1] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:19:50,456] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:19:50,469] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:19:51,250] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:19:51,337] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:19:51,461] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, my_first-0 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, hello-producer-topic-sample-2 -> OfflinePartition, __consumer_offsets-17 -> OnlinePartition, hello-producer-topic-2 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, myfirst-0 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, TextLinesTopic-1 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, wordcount-application-counts-store-repartition-2 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, hello-producer-topic-sample-1 -> OfflinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, hello-producer-topic-3 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, WordsWithCountsTopic-2 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, myfirst-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, invoice-0 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, TextLinesTopic-0 -> OnlinePartition, wordcount-application-counts-store-changelog-2 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, hello-producer-topic-sample-0 -> OfflinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, hello-producer-topic-4 -> OnlinePartition, hello-producer-topic-sample-4 -> OfflinePartition, hello-producer-topic-0 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, wordcount-application-counts-store-repartition-0 -> OnlinePartition, myfirst-2 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, WordsWithCountsTopic-1 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, wordcount-application-counts-store-changelog-1 -> OnlinePartition, invoice-1 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, myjob-0 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, hello-producer-topic-sample-3 -> OfflinePartition, __consumer_offsets-18 -> OnlinePartition, hello-producer-topic-1 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, WordsWithCountsTopic-0 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, TextLinesTopic-2 -> OnlinePartition, invoice-2 -> OnlinePartition, wordcount-application-counts-store-changelog-0 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, wordcount-application-counts-store-repartition-1 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:19:51,462] INFO [Controller id=0] Ready to serve as the new controller with epoch 23 (kafka.controller.KafkaController)
[2020-03-02 09:19:51,498] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,530] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:19:51,531] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:19:51,532] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:19:51,533] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:19:51,536] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:19:51,567] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:19:51,780] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-03-02 09:19:51,781] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:19:51,822] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:19:51,835] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-03-02 09:19:51,859] INFO [Controller id=0] Some replicas [Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=1,Replica=1] for topics scheduled for deletion hello-producer-topic-sample are on the newly restarted brokers 1. Signaling restart of topic deletion for these topics (kafka.controller.KafkaController)
[2020-03-02 09:19:51,861] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,863] INFO [Topic Deletion Manager 0] Deletion of topic hello-producer-topic-sample (re)started (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,864] INFO [Topic Deletion Manager 0] Topic deletion callback for hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,878] INFO [Topic Deletion Manager 0] Partition deletion callback for hello-producer-topic-sample-0,hello-producer-topic-sample-3,hello-producer-topic-sample-4,hello-producer-topic-sample-1,hello-producer-topic-sample-2 (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,905] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:19:51,987] DEBUG The stop replica request (delete = false) sent to broker 0 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=0],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=0],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:19:51,988] DEBUG The stop replica request (delete = false) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],false),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],false) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:19:51,989] DEBUG [Topic Deletion Manager 0] Deletion started for replicas [Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=1,Replica=1] (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,993] DEBUG The stop replica request (delete = true) sent to broker 0 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=3,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=0],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=2,Replica=0],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:19:51,995] DEBUG The stop replica request (delete = true) sent to broker 1 is StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=4,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=0,Replica=1],true),StopReplicaRequestInfo([Topic=hello-producer-topic-sample,Partition=1,Replica=1],true) (kafka.controller.ControllerBrokerRequestBatch)
[2020-03-02 09:19:51,996] DEBUG [Topic Deletion Manager 0] Dead Replicas ([Topic=hello-producer-topic-sample,Partition=1,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=3,Replica=2]) found for topic hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,998] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to offline replicas (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:51,998] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2020-03-02 09:19:52,006] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 1055, 1 -> 1065) (kafka.controller.KafkaController)
[2020-03-02 09:19:53,686] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 1: request error = NONE, partition errors = Map(hello-producer-topic-sample-1 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-0 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-4 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2020-03-02 09:19:53,693] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=hello-producer-topic-sample,Partition=1,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=4,Replica=1]. Halting deletion for topics Set(hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:53,695] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:53,695] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:54,774] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = Map(hello-producer-topic-sample-0 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-3 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-2 -> KAFKA_STORAGE_ERROR, hello-producer-topic-sample-4 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2020-03-02 09:19:54,779] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=0]. Halting deletion for topics Set(hello-producer-topic-sample) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:54,781] INFO [Topic Deletion Manager 0] Halted deletion of topics hello-producer-topic-sample due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:54,781] INFO [Topic Deletion Manager 0] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:54,788] INFO [Topic Deletion Manager 0] Retrying deletion of topic hello-producer-topic-sample since replicas [Topic=hello-producer-topic-sample,Partition=3,Replica=0],[Topic=hello-producer-topic-sample,Partition=4,Replica=1],[Topic=hello-producer-topic-sample,Partition=0,Replica=0],[Topic=hello-producer-topic-sample,Partition=2,Replica=2],[Topic=hello-producer-topic-sample,Partition=2,Replica=0],[Topic=hello-producer-topic-sample,Partition=0,Replica=1],[Topic=hello-producer-topic-sample,Partition=3,Replica=2],[Topic=hello-producer-topic-sample,Partition=1,Replica=1],[Topic=hello-producer-topic-sample,Partition=4,Replica=0],[Topic=hello-producer-topic-sample,Partition=1,Replica=2] were not successfully deleted (kafka.controller.TopicDeletionManager)
[2020-03-02 09:19:57,329] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 09:19:57,377] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 09:20:03,007] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 24 and epoch zk version is now 24 (kafka.controller.KafkaController)
[2020-03-02 09:20:03,007] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 09:20:03,019] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 09:20:03,028] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 09:20:03,041] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 09:20:03,059] INFO [Controller id=2] Initialized broker epochs cache: Map(2 -> 1157) (kafka.controller.KafkaController)
[2020-03-02 09:20:03,115] DEBUG [Controller id=2] Register BrokerModifications handler for Set(2) (kafka.controller.KafkaController)
[2020-03-02 09:20:03,184] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 09:20:03,200] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-03-02 09:20:03,202] INFO [Controller id=2] Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2020-03-02 09:20:03,203] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 09:20:03,203] INFO [Controller id=2] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 09:20:03,204] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 09:20:03,214] INFO [Controller id=2] List of topics to be deleted: hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 09:20:03,215] INFO [Controller id=2] List of topics ineligible for deletion: myjob,myfirst,WordsWithCountsTopic,hello-producer-topic-sample,__consumer_offsets,invoice,TextLinesTopic,wordcount-application-counts-store-changelog,my_first,wordcount-application-counts-store-repartition,hello-producer-topic (kafka.controller.KafkaController)
[2020-03-02 09:20:03,216] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 09:20:03,217] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(hello-producer-topic-sample), initial ineligible deletions: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.TopicDeletionManager)
[2020-03-02 09:20:03,218] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 09:20:03,239] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:20:03,259] INFO [RequestSendThread controllerId=2] Controller 2 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 09:20:03,260] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:20:03,357] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:20:03,791] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=2] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=myjob,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=2] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OfflineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=1] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 09:20:03,792] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:20:03,806] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:20:04,080] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, my_first-0 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, hello-producer-topic-sample-2 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, hello-producer-topic-2 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, myfirst-0 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, TextLinesTopic-1 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, wordcount-application-counts-store-repartition-2 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, hello-producer-topic-sample-1 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, hello-producer-topic-3 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, WordsWithCountsTopic-2 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, myfirst-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, invoice-0 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, TextLinesTopic-0 -> OfflinePartition, wordcount-application-counts-store-changelog-2 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, hello-producer-topic-sample-0 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, hello-producer-topic-4 -> OfflinePartition, hello-producer-topic-sample-4 -> OfflinePartition, hello-producer-topic-0 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, wordcount-application-counts-store-repartition-0 -> OfflinePartition, myfirst-2 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, WordsWithCountsTopic-1 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, wordcount-application-counts-store-changelog-1 -> OfflinePartition, invoice-1 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, myjob-0 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, hello-producer-topic-sample-3 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, hello-producer-topic-1 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, WordsWithCountsTopic-0 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, TextLinesTopic-2 -> OfflinePartition, invoice-2 -> OfflinePartition, wordcount-application-counts-store-changelog-0 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, wordcount-application-counts-store-repartition-1 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 09:20:04,081] INFO [Controller id=2] Ready to serve as the new controller with epoch 24 (kafka.controller.KafkaController)
[2020-03-02 09:20:04,090] INFO [Topic Deletion Manager 2] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 09:20:04,099] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:20:04,101] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 09:20:04,102] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 09:20:04,103] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 09:20:04,106] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 09:20:04,214] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 09:20:09,217] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 09:20:09,218] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 09:20:09,232] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 09:20:09,240] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 09:20:09,243] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:20:09,252] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:20:09,253] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 09:20:09,253] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:20:09,253] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:20:09,253] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 09:20:09,253] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 09:20:09,257] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 09:20:09,266] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 09:20:09,267] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-3 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 09:20:09,268] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 09:20:09,268] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:13:39,687] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:13:42,873] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:13:42,882] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 10:13:42,884] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 10:13:42,884] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:13:42,885] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:42,886] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 10:13:42,886] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:13:42,886] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:42,886] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 10:13:42,886] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:13:42,886] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:45,339] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /brokers/topics/hello-producer-topic/partitions/0/state
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:554)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$2(PartitionStateMachine.scala:402)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:378)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:13:45,340] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
org.apache.zookeeper.KeeperException$SessionExpiredException: KeeperErrorCode = Session expired for /brokers/topics/hello-producer-topic/partitions/3/state
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:134)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:54)
	at kafka.zookeeper.AsyncResponse.resultException(ZooKeeperClient.scala:554)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$2(PartitionStateMachine.scala:402)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:378)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:13:45,341] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:13:45,341] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:13:45,344] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-03-02 10:13:45,345] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set(2) (kafka.controller.KafkaController)
[2020-03-02 10:13:45,400] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:13:45,403] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:13:45,405] INFO [RequestSendThread controllerId=2] Shutting down (kafka.controller.RequestSendThread)
[2020-03-02 10:13:45,408] INFO [RequestSendThread controllerId=2] Stopped (kafka.controller.RequestSendThread)
[2020-03-02 10:13:45,410] INFO [RequestSendThread controllerId=2] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-02 10:13:45,418] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-03-02 10:13:45,806] INFO [Controller id=2] 2 successfully elected as the controller. Epoch incremented to 25 and epoch zk version is now 25 (kafka.controller.KafkaController)
[2020-03-02 10:13:45,806] INFO [Controller id=2] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 10:13:45,949] INFO [Controller id=2] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 10:13:46,058] INFO [Controller id=2] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 10:13:46,099] INFO [Controller id=2] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 10:13:46,156] INFO [Controller id=2] Initialized broker epochs cache: Map(2 -> 1242) (kafka.controller.KafkaController)
[2020-03-02 10:13:46,234] DEBUG [Controller id=2] Register BrokerModifications handler for Set(2) (kafka.controller.KafkaController)
[2020-03-02 10:13:46,420] DEBUG [Channel manager on controller 2]: Controller 2 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 10:13:46,431] INFO [Controller id=2] Currently active brokers in the cluster: Set(2) (kafka.controller.KafkaController)
[2020-03-02 10:13:46,431] INFO [Controller id=2] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 10:13:46,432] INFO [Controller id=2] Current list of topics in the cluster: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 10:13:46,432] INFO [Controller id=2] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 10:13:46,433] INFO [RequestSendThread controllerId=2] Starting (kafka.controller.RequestSendThread)
[2020-03-02 10:13:46,438] INFO [Controller id=2] List of topics to be deleted: hello-producer-topic-sample (kafka.controller.KafkaController)
[2020-03-02 10:13:46,438] INFO [Controller id=2] List of topics ineligible for deletion: myjob,myfirst,WordsWithCountsTopic,hello-producer-topic-sample,__consumer_offsets,invoice,TextLinesTopic,wordcount-application-counts-store-changelog,my_first,wordcount-application-counts-store-repartition,hello-producer-topic (kafka.controller.KafkaController)
[2020-03-02 10:13:46,438] INFO [Controller id=2] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 10:13:46,439] INFO [Topic Deletion Manager 2] Initializing manager with initial deletions: Set(hello-producer-topic-sample), initial ineligible deletions: HashSet(myjob, myfirst, WordsWithCountsTopic, hello-producer-topic-sample, __consumer_offsets, invoice, TextLinesTopic, wordcount-application-counts-store-changelog, my_first, wordcount-application-counts-store-repartition, hello-producer-topic) (kafka.controller.TopicDeletionManager)
[2020-03-02 10:13:46,439] INFO [Controller id=2] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 10:13:46,440] INFO [ReplicaStateMachine controllerId=2] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:13:46,442] INFO [ReplicaStateMachine controllerId=2] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:13:46,443] INFO [RequestSendThread controllerId=2] Controller 2 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 10:13:46,462] INFO [ReplicaStateMachine controllerId=2] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:13:47,212] DEBUG [ReplicaStateMachine controllerId=2] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=2] -> OnlineReplica, [Topic=my_first,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=myjob,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=2] -> OnlineReplica, [Topic=TextLinesTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=1,Replica=1] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica, [Topic=myfirst,Partition=2,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=1,Replica=0] -> OfflineReplica, [Topic=invoice,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OfflineReplica, [Topic=TextLinesTopic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OfflineReplica, [Topic=WordsWithCountsTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OnlineReplica, [Topic=invoice,Partition=1,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-changelog,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=2,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=4,Replica=1] -> OfflineReplica, [Topic=wordcount-application-counts-store-repartition,Partition=0,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=TextLinesTopic,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=hello-producer-topic-sample,Partition=2,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:13:47,212] INFO [PartitionStateMachine controllerId=2] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:13:47,213] INFO [PartitionStateMachine controllerId=2] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:13:47,485] DEBUG [PartitionStateMachine controllerId=2] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, my_first-0 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, hello-producer-topic-sample-2 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, hello-producer-topic-2 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, myfirst-0 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, TextLinesTopic-1 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, wordcount-application-counts-store-repartition-2 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, hello-producer-topic-sample-1 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, hello-producer-topic-3 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, WordsWithCountsTopic-2 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, myfirst-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, invoice-0 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, TextLinesTopic-0 -> OfflinePartition, wordcount-application-counts-store-changelog-2 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, hello-producer-topic-sample-0 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, hello-producer-topic-4 -> OfflinePartition, hello-producer-topic-sample-4 -> OfflinePartition, hello-producer-topic-0 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, wordcount-application-counts-store-repartition-0 -> OfflinePartition, myfirst-2 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, WordsWithCountsTopic-1 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, wordcount-application-counts-store-changelog-1 -> OfflinePartition, invoice-1 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, myjob-0 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, hello-producer-topic-sample-3 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, hello-producer-topic-1 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, WordsWithCountsTopic-0 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, TextLinesTopic-2 -> OfflinePartition, invoice-2 -> OfflinePartition, wordcount-application-counts-store-changelog-0 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, wordcount-application-counts-store-repartition-1 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:13:47,485] INFO [Controller id=2] Ready to serve as the new controller with epoch 25 (kafka.controller.KafkaController)
[2020-03-02 10:13:47,516] INFO [Topic Deletion Manager 2] Handling deletion for topics hello-producer-topic-sample (kafka.controller.TopicDeletionManager)
[2020-03-02 10:13:47,537] INFO [Controller id=2] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 10:13:47,537] INFO [Controller id=2] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 10:13:47,537] INFO [Controller id=2] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 10:13:47,537] INFO [Controller id=2] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 10:13:47,537] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:47,556] INFO [Controller id=2] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 10:13:52,557] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:13:52,557] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:13:52,561] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 10:13:52,561] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 10:13:52,561] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:13:52,562] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:52,562] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 10:13:52,562] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:13:52,562] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:52,562] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 10:13:52,562] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:13:52,563] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:13:52,568] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:13:52,568] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-3 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:13:52,569] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:13:52,569] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:18:52,577] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:18:52,577] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:18:52,581] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 10:18:52,582] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 10:18:52,582] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:18:52,582] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:18:52,582] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 10:18:52,582] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:18:52,583] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:18:52,583] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 10:18:52,583] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:18:52,583] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:18:52,588] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:18:52,588] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-3 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:18:52,588] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:18:52,588] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:23:52,600] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:23:52,601] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:23:52,604] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 10:23:52,605] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 10:23:52,606] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:23:52,606] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:23:52,607] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 10:23:52,607] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:23:52,607] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:23:52,607] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 10:23:52,607] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:23:52,607] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:23:52,624] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:23:52,624] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-3 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:23:52,625] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:23:52,625] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:28:52,633] INFO [Controller id=2] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:28:52,633] TRACE [Controller id=2] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:28:52,635] DEBUG [Controller id=2] Preferred replicas by broker HashMap(0 -> HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)), 1 -> HashMap(hello-producer-topic-2 -> List(1, 2, 0)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1))) (kafka.controller.KafkaController)
[2020-03-02 10:28:52,635] DEBUG [Controller id=2] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-30 -> List(0), __consumer_offsets-35 -> List(0), __consumer_offsets-37 -> List(0), wordcount-application-counts-store-repartition-2 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-13 -> List(0), invoice-2 -> List(0), __consumer_offsets-22 -> List(0), myfirst-2 -> List(0), hello-producer-topic-4 -> List(0, 2, 1), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), WordsWithCountsTopic-2 -> List(0), wordcount-application-counts-store-repartition-0 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-33 -> List(0), wordcount-application-counts-store-changelog-0 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), myfirst-0 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), invoice-0 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), wordcount-application-counts-store-repartition-1 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), WordsWithCountsTopic-0 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), wordcount-application-counts-store-changelog-1 -> List(0), __consumer_offsets-43 -> List(0), TextLinesTopic-1 -> List(0), myfirst-1 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), WordsWithCountsTopic-1 -> List(0), TextLinesTopic-2 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), my_first-0 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-45 -> List(0), wordcount-application-counts-store-changelog-2 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0), invoice-1 -> List(0), myjob-0 -> List(0), hello-producer-topic-1 -> List(0, 1, 2), TextLinesTopic-0 -> List(0)) (kafka.controller.KafkaController)
[2020-03-02 10:28:52,635] TRACE [Controller id=2] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:28:52,636] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:28:52,636] DEBUG [Controller id=2] Topics not in preferred replica for broker 1 HashMap(hello-producer-topic-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2020-03-02 10:28:52,636] TRACE [Controller id=2] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:28:52,636] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:28:52,636] DEBUG [Controller id=2] Topics not in preferred replica for broker 2 HashMap(hello-producer-topic-3 -> List(2, 1, 0), hello-producer-topic-0 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2020-03-02 10:28:52,636] TRACE [Controller id=2] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2020-03-02 10:28:52,637] INFO [Controller id=2] Starting replica leader election (PREFERRED) for partitions hello-producer-topic-3,hello-producer-topic-0 triggered by AutoTriggered (kafka.controller.KafkaController)
[2020-03-02 10:28:52,642] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-0 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-0 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:28:52,642] ERROR [Controller id=2] Error completing replica leader election (PREFERRED) for partition hello-producer-topic-3 (kafka.controller.KafkaController)
kafka.common.StateChangeFailedException: Failed to elect leader for partition hello-producer-topic-3 under strategy PreferredReplicaPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:427)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:553)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:551)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:921)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:424)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:236)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:157)
	at kafka.controller.KafkaController.onReplicaElection(KafkaController.scala:764)
	at kafka.controller.KafkaController.$anonfun$checkAndTriggerAutoLeaderRebalance$6(KafkaController.scala:1135)
	at scala.collection.immutable.HashMap.foreach(HashMap.scala:1049)
	at kafka.controller.KafkaController.checkAndTriggerAutoLeaderRebalance(KafkaController.scala:1116)
	at kafka.controller.KafkaController.processAutoPreferredReplicaLeaderElection(KafkaController.scala:1144)
	at kafka.controller.KafkaController.process(KafkaController.scala:1864)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:137)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:137)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2020-03-02 10:28:52,643] WARN [Controller id=2] Partition hello-producer-topic-3 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:28:52,643] WARN [Controller id=2] Partition hello-producer-topic-0 failed to complete preferred replica leader election to 2. Leader is still -1 (kafka.controller.KafkaController)
[2020-03-02 10:32:02,115] DEBUG preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@66d3c617, name=log4j:logger=kafka.controller (kafka.controller)
[2020-03-02 10:32:43,500] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 10:32:43,599] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2020-03-02 10:32:43,600] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 10:32:43,608] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 10:32:43,615] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 10:32:43,623] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 10:32:43,687] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 24) (kafka.controller.KafkaController)
[2020-03-02 10:32:43,695] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2020-03-02 10:32:43,706] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 10:32:43,724] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 10:32:43,726] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2020-03-02 10:32:43,727] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 10:32:43,728] INFO [Controller id=0] Current list of topics in the cluster: Set() (kafka.controller.KafkaController)
[2020-03-02 10:32:43,729] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 10:32:43,739] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 10:32:43,740] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-02 10:32:43,741] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 10:32:43,742] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-03-02 10:32:43,744] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 10:32:43,767] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:32:43,769] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:32:43,792] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:32:43,793] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 10:32:43,794] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:32:43,801] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:32:43,816] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 10:32:43,816] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 10:32:43,817] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2020-03-02 10:32:43,838] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 10:32:43,839] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 10:32:43,841] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 10:32:43,842] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 10:32:43,845] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 10:32:43,896] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 10:32:48,907] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:32:48,908] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:32:48,913] DEBUG [Controller id=0] Preferred replicas by broker HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:33:06,404] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2020-03-02 10:33:06,405] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 10:33:06,456] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 10:33:06,862] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2020-03-02 10:33:06,866] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 10:33:07,449] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 10:33:07,474] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2020-03-02 10:33:07,539] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 24, 1 -> 43) (kafka.controller.KafkaController)
[2020-03-02 10:33:07,942] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 10:33:11,068] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2020-03-02 10:33:11,069] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 10:33:11,081] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 10:33:11,081] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2020-03-02 10:33:11,083] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2020-03-02 10:33:11,086] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 10:33:11,095] INFO [Controller id=0] Updated broker epochs cache: Map(0 -> 24, 1 -> 43, 2 -> 59) (kafka.controller.KafkaController)
[2020-03-02 10:33:11,222] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2020-03-02 10:33:11,266] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2020-03-02 10:33:43,512] INFO [Controller id=0] New topics: [Set(hello-producer-topic)], deleted topics: [Set()], new partition replica assignment [HashMap(hello-producer-topic-0 -> ReplicaAssignment(replicas=2,1,0, addingReplicas=, removingReplicas=), hello-producer-topic-2 -> ReplicaAssignment(replicas=1,0,2, addingReplicas=, removingReplicas=), hello-producer-topic-1 -> ReplicaAssignment(replicas=0,2,1, addingReplicas=, removingReplicas=), hello-producer-topic-3 -> ReplicaAssignment(replicas=2,0,1, addingReplicas=, removingReplicas=), hello-producer-topic-4 -> ReplicaAssignment(replicas=0,1,2, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-03-02 10:33:43,519] INFO [Controller id=0] New partition creation callback for hello-producer-topic-0,hello-producer-topic-2,hello-producer-topic-1,hello-producer-topic-3,hello-producer-topic-4 (kafka.controller.KafkaController)
[2020-03-02 10:33:58,439] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [Set()], new partition replica assignment [HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=))] (kafka.controller.KafkaController)
[2020-03-02 10:33:58,439] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2020-03-02 10:37:48,922] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:37:48,922] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:37:48,929] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 10:37:48,933] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:37:48,936] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:37:48,937] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:37:48,937] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:37:48,937] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:37:48,937] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:42:48,953] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:47:48,952] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:47:48,952] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:47:48,963] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 10:47:48,964] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:47:48,964] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:47:48,964] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:47:48,964] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:47:48,965] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:47:48,965] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:52:48,974] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:52:48,974] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:52:48,980] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 10:52:48,981] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:52:48,981] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:52:48,981] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:52:48,981] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:52:48,981] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:52:48,981] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 10:57:48,991] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 11:09:35,532] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 11:09:35,534] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 11:09:35,535] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 11:09:35,536] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 11:09:35,536] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 11:09:35,536] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 11:09:35,536] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 11:09:35,536] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 11:09:35,536] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 11:09:37,193] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2020-03-02 11:09:37,194] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2020-03-02 11:09:37,198] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 11:09:37,199] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:37,201] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,202] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,204] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,210] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,210] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,212] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,232] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,233] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,233] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2020-03-02 11:09:37,239] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2020-03-02 11:09:37,640] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2020-03-02 11:09:37,642] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-03-02 11:09:37,646] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 11:09:37,649] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:37,652] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2020-03-02 11:09:37,712] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2020-03-02 11:09:37,715] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2020-03-02 11:09:37,719] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 11:09:37,721] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:37,725] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2020-03-02 11:09:42,525] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2020-03-02 11:09:42,525] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2020-03-02 11:09:42,784] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2020-03-02 11:09:42,796] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2020-03-02 11:09:42,826] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2020-03-02 11:09:42,848] DEBUG [Controller id=2] Broker 0 was elected as controller instead of broker 2 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-03-02 11:09:42,850] INFO [Controller id=0] Initialized broker epochs cache: Map(0 -> 187, 1 -> 189, 2 -> 188) (kafka.controller.KafkaController)
[2020-03-02 11:09:42,858] DEBUG [Controller id=1] Broker 0 was elected as controller instead of broker 1 (kafka.controller.KafkaController)
org.apache.kafka.common.errors.ControllerMovedException: Controller moved to another broker. Aborting controller startup procedure
[2020-03-02 11:09:42,958] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0, 1, 2) (kafka.controller.KafkaController)
[2020-03-02 11:09:43,055] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2020-03-02 11:09:43,062] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2020-03-02 11:09:43,068] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2020-03-02 11:09:43,075] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 11:09:43,075] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 11:09:43,076] INFO [Controller id=0] Currently active brokers in the cluster: Set(0, 1, 2) (kafka.controller.KafkaController)
[2020-03-02 11:09:43,076] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2020-03-02 11:09:43,076] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2020-03-02 11:09:43,076] INFO [Controller id=0] Current list of topics in the cluster: Set(__consumer_offsets, hello-producer-topic) (kafka.controller.KafkaController)
[2020-03-02 11:09:43,076] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2020-03-02 11:09:43,084] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2020-03-02 11:09:43,084] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2020-03-02 11:09:43,084] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2020-03-02 11:09:43,084] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: Set() (kafka.controller.TopicDeletionManager)
[2020-03-02 11:09:43,084] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2020-03-02 11:09:43,085] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:43,087] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 11:09:43,088] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 11:09:43,088] INFO [RequestSendThread controllerId=0] Controller 0 connected to DELL-PC:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2020-03-02 11:09:43,095] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:43,147] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:43,147] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=46,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=1] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=1] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=40,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=1,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=0,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=hello-producer-topic,Partition=2,Replica=1] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=26,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=1,Replica=1] -> OnlineReplica, [Topic=hello-producer-topic,Partition=4,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=2,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=25,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=2] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=2] -> OnlineReplica, [Topic=hello-producer-topic,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=1] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2020-03-02 11:09:43,147] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 11:09:43,148] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 11:09:43,148] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, hello-producer-topic-2 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, hello-producer-topic-3 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, hello-producer-topic-4 -> OnlinePartition, hello-producer-topic-0 -> OnlinePartition, __consumer_offsets-32 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, hello-producer-topic-1 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2020-03-02 11:09:43,149] INFO [Controller id=0] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2020-03-02 11:09:43,173] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 11:09:43,173] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2020-03-02 11:09:43,173] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2020-03-02 11:09:43,173] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2020-03-02 11:09:43,173] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2020-03-02 11:09:43,201] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2020-03-02 11:09:48,202] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2020-03-02 11:09:48,202] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2020-03-02 11:09:48,207] DEBUG [Controller id=0] Preferred replicas by broker HashMap(0 -> HashMap(hello-producer-topic-4 -> List(0, 1, 2), __consumer_offsets-30 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-45 -> List(0), hello-producer-topic-1 -> List(0, 2, 1), __consumer_offsets-27 -> List(0), __consumer_offsets-9 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0)), 1 -> HashMap(__consumer_offsets-22 -> List(1), __consumer_offsets-4 -> List(1), __consumer_offsets-25 -> List(1), __consumer_offsets-49 -> List(1), __consumer_offsets-31 -> List(1), __consumer_offsets-37 -> List(1), __consumer_offsets-19 -> List(1), __consumer_offsets-13 -> List(1), __consumer_offsets-43 -> List(1), __consumer_offsets-1 -> List(1), __consumer_offsets-34 -> List(1), __consumer_offsets-7 -> List(1), __consumer_offsets-46 -> List(1), __consumer_offsets-16 -> List(1), hello-producer-topic-2 -> List(1, 0, 2), __consumer_offsets-28 -> List(1), __consumer_offsets-10 -> List(1), __consumer_offsets-40 -> List(1)), 2 -> HashMap(hello-producer-topic-3 -> List(2, 0, 1), __consumer_offsets-8 -> List(2), __consumer_offsets-35 -> List(2), hello-producer-topic-0 -> List(2, 1, 0), __consumer_offsets-47 -> List(2), __consumer_offsets-38 -> List(2), __consumer_offsets-17 -> List(2), __consumer_offsets-11 -> List(2), __consumer_offsets-29 -> List(2), __consumer_offsets-32 -> List(2), __consumer_offsets-41 -> List(2), __consumer_offsets-23 -> List(2), __consumer_offsets-2 -> List(2), __consumer_offsets-14 -> List(2), __consumer_offsets-20 -> List(2), __consumer_offsets-44 -> List(2), __consumer_offsets-5 -> List(2), __consumer_offsets-26 -> List(2))) (kafka.controller.KafkaController)
[2020-03-02 11:09:48,207] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2020-03-02 11:09:48,207] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 11:09:48,208] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2020-03-02 11:09:48,208] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2020-03-02 11:09:48,208] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2020-03-02 11:09:48,208] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
